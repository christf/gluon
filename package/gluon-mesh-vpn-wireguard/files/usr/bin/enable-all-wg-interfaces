#!/bin/sh

get_down_wg_backbone_interfaces() {
# TODO: only show enabled peers from peer-group mesh_vpn_backbone
  ubus -S call network.interface dump | jsonfilter -e '@.interface[@.up=false && @.proto="gluon_wireguard"].interface'
}

if [[ $(uci get wireguard.mesh_vpn_backbone.enabled) == "1" ]] &&
  for i in $(get_down_wg_backbone_interfaces)
  do
    ifup $i
  done
fi

